<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      wishyouhappy
    
  </title>

  <link rel="shortcut icon" type="image/x-icon"  href="/public/image/leave.ico">

  <!-- CSS -->
  <link type="text/css" rel="stylesheet" href="http://fast.fonts.com/cssapi/d70ca5cd-778e-48cc-9e59-6b276425c670.css"/>
  <link rel="stylesheet" href="/public/css/css.css">
  <link rel="stylesheet" href="/public/css/style.css">
   <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/base.css">
  <link rel="stylesheet" href="/public/css/web-fonts.css" media="screen, projection" />

  <link media="only screen and (max-device-width: 480px)" href="/public/css/mobile.css" />
  <!-- RSS -->
 <!--  <link rel="alternate" type="application/atom+xml" title="wishyouhappy" href="/atom.xml"> -->

</head>


  <body>
  <div class="top-title">
  <div class="header">
      <div class="container" >
          <ul class = "menu">
          
            &nbsp;&nbsp;&nbsp;
            
              <li ><a href="/about" style="color: #626262 ">About</a></li>
            
          
            &nbsp;&nbsp;&nbsp;
            
              <li ><a href="/blogs" style="color: #626262 ">Blogs</a></li>
            
          
            &nbsp;&nbsp;&nbsp;
            
              <li ><a href="/photos" style="color: #626262 ">Photo</a></li>
            
          
            &nbsp;&nbsp;&nbsp;
            
              <li ><a href="/gallary" style="color: #626262 ">Gallary</a></li>
            
          
          </ul>
          <section class = "name">
<!--             <a href="/" title="Home"><b>wishyouhappy</b></a>
 -->          
             <a href="/" title="Home" style="color: #565656; font-weight:800">wishyouhappy</a>

           </section>
      </div>  
    </div>
    </div>
  <div class = "main-div">
    
      <div class="container">
      <main>
        <div class="container">
  
  
    <h2 class="post-title">
      <a href="/2014/12/17/morris%20traversal-traverse%20a%20binary%20tree%20without%20stack/">
        Morris traversal-traverse a binary tree without stack
      </a>
    </h2>
    <div class ="margin5"></div>
    <time datetime="2014-12-17T00:00:00-06:00" class="post-date">17 Dec 2014</time>

  
 
  <div class ="container">

<h2>About morris traversal</h2>

<p>It aims at traversing an binary tree in inorder without using stack.</p>

<p>The main idea:<br/>
Create links to the successor(use leaf node's left or right null pointer)<br/>
Print the data using these links<br>
Revert the changes to restore original tree.</p>

<h2>Inorder Example</h2>

<p>Let's explain inorder traversal as an example:
If the current node has left child, find the predecessor of current node, set current as its right child. In this way, we can return to parent after finish traverse the left subtree.</p>

<p>See details on the following picture:</p>

<img src= "/public/image/morristraversal1.jpg">

<p>The presudo code is below:</p>


    <div class="code-block">
    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="n">initialize</span> <span class="n">current</span> <span class="k">as</span> <span class="n">root</span>
<span class="lineno"> 2</span>   <span class="k">while</span> <span class="n">current</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
<span class="lineno"> 3</span>     <span class="k">if</span> <span class="n">current</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">left</span> <span class="n">child</span><span class="p">:</span> 
<span class="lineno"> 4</span>        <span class="n">a</span><span class="o">.</span> <span class="n">Print</span> <span class="n">current</span><span class="err">â€™</span><span class="n">s</span> <span class="n">data</span>
<span class="lineno"> 5</span>        <span class="n">b</span><span class="o">.</span> <span class="n">Go</span> <span class="n">to</span> <span class="n">the</span> <span class="n">right</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">right</span>
<span class="lineno"> 6</span>     <span class="k">else</span><span class="p">:</span>
<span class="lineno"> 7</span>        <span class="n">a</span><span class="o">.</span> <span class="n">Find</span> <span class="n">the</span> <span class="n">predecessor</span> <span class="n">of</span> <span class="n">current</span> <span class="n">node</span>
<span class="lineno"> 8</span>        <span class="n">b</span><span class="o">.</span> <span class="k">if</span> <span class="n">predecessor</span><span class="s">&#39;s right child is null:</span>
<span class="lineno"> 9</span>            <span class="mi">1</span><span class="p">)</span> <span class="n">make</span> <span class="n">current</span> <span class="n">the</span> <span class="n">right</span> <span class="n">child</span> <span class="n">of</span> <span class="n">its</span> <span class="n">predecessor</span>
<span class="lineno">10</span>            <span class="mi">2</span><span class="p">)</span><span class="n">Go</span> <span class="n">to</span> <span class="n">this</span> <span class="n">left</span> <span class="n">child</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">left</span>
<span class="lineno">11</span>         <span class="k">else</span><span class="p">:</span>
<span class="lineno">12</span>            <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">predecessor</span><span class="s">&#39;s right child is current node, set predecessor&#39;</span><span class="n">s</span> <span class="n">right</span> <span class="n">child</span> <span class="n">to</span> <span class="n">null</span>
<span class="lineno">13</span>            <span class="mi">2</span><span class="p">)</span> <span class="k">print</span> <span class="n">current</span> <span class="n">node</span><span class="p">,</span> <span class="nb">set</span> <span class="n">current</span> <span class="n">node</span> <span class="n">to</span> <span class="n">its</span> <span class="n">right</span> <span class="n">child</span></code></pre></div>
    </div>



<h2>Jave implementation:</h2>

    <div class="code-block">
    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">morrisTraversal</span><span class="o">(</span><span class="n">TreeNode</span> <span class="n">root</span><span class="o">){</span>
<span class="lineno"> 2</span>         <span class="k">if</span><span class="o">(</span><span class="n">root</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span><span class="o">;</span>
<span class="lineno"> 3</span>         
<span class="lineno"> 4</span>         <span class="n">TreeNode</span> <span class="n">pre</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno"> 5</span>         <span class="k">while</span><span class="o">(</span><span class="n">root</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno"> 6</span>             <span class="k">if</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">left</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno"> 7</span>                 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">val</span><span class="o">);</span>
<span class="lineno"> 8</span>                 <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno"> 9</span>             <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">10</span>                 <span class="cm">/* find predecessor */</span>
<span class="lineno">11</span>                 <span class="n">pre</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">12</span>                 <span class="k">while</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="n">root</span><span class="o">)</span>
<span class="lineno">13</span>                     <span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">14</span>                 
<span class="lineno">15</span>                 <span class="cm">/* if predecessor&#39;s right == null, set current node as its right child */</span>
<span class="lineno">16</span>                 <span class="k">if</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno">17</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">18</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">19</span>                 <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">20</span>                     <span class="cm">/* recover tree, when return to parent node the second time */</span>
<span class="lineno">21</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno">22</span>                     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">val</span><span class="o">);</span>
<span class="lineno">23</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">24</span>                 <span class="o">}</span>
<span class="lineno">25</span>             <span class="o">}</span>
<span class="lineno">26</span>         <span class="o">}</span>
<span class="lineno">27</span>     <span class="o">}</span></code></pre></div>
    </div>

<h2>Analysis:</h2>

<p>To find predecessor, we visit a node at most 3 times, so the overall time complexity is O(n)</p>

<h2>Preorder and Postorder</h2>

<p>The morris traverse can be applied to preorder traverse and postorder traverse with some changes.</p>

<h3>preorder</h3>

<p>It's very similar with inorder, just change the print out sequence.</p>

<p>The presudo code is below:</p>


 
    <div class="code-block">
    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="n">initialize</span> <span class="n">current</span> <span class="k">as</span> <span class="n">root</span>
<span class="lineno"> 2</span>   <span class="k">while</span> <span class="n">current</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span>
<span class="lineno"> 3</span>     <span class="k">if</span> <span class="n">current</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">left</span> <span class="n">child</span><span class="p">:</span>  
<span class="lineno"> 4</span>        <span class="n">a</span><span class="o">.</span> <span class="n">Print</span> <span class="n">current</span> <span class="n">node</span>
<span class="lineno"> 5</span>        <span class="n">b</span><span class="o">.</span> <span class="n">Go</span> <span class="n">to</span> <span class="n">the</span> <span class="n">right</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">right</span>
<span class="lineno"> 6</span>     <span class="k">else</span>
<span class="lineno"> 7</span>        <span class="n">a</span><span class="o">.</span> <span class="n">Find</span> <span class="n">the</span> <span class="n">predecessor</span> <span class="n">of</span> <span class="n">current</span> <span class="n">node</span>
<span class="lineno"> 8</span>        <span class="n">b</span><span class="o">.</span> <span class="k">if</span> <span class="n">predecessor</span><span class="s">&#39;s right child is null:</span>
<span class="lineno"> 9</span>            <span class="mi">1</span><span class="p">)</span> <span class="n">make</span> <span class="n">current</span> <span class="n">the</span> <span class="n">right</span> <span class="n">child</span> <span class="n">of</span> <span class="n">its</span> <span class="n">predecessor</span>
<span class="lineno">10</span>            <span class="mi">2</span><span class="p">)</span> <span class="n">Print</span> <span class="n">current</span> <span class="n">node</span>
<span class="lineno">11</span>            <span class="mi">3</span><span class="p">)</span><span class="n">Go</span> <span class="n">to</span> <span class="n">this</span> <span class="n">left</span> <span class="n">child</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">left</span>
<span class="lineno">12</span>         <span class="k">else</span><span class="p">:</span>
<span class="lineno">13</span>            <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">predecessor</span><span class="s">&#39;s right child is current node, set predecessor&#39;</span><span class="n">s</span> <span class="n">right</span> <span class="n">child</span> <span class="n">to</span> <span class="n">null</span>
<span class="lineno">14</span>            <span class="mi">2</span><span class="p">)</span> <span class="nb">set</span> <span class="n">current</span> <span class="n">node</span> <span class="n">to</span> <span class="n">its</span> <span class="n">right</span> <span class="n">child</span></code></pre></div>
    </div>


<p>java implementation:</p>

    <div class="code-block">
    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">morrisTraversal</span><span class="o">(</span><span class="n">TreeNode</span> <span class="n">root</span><span class="o">){</span>
<span class="lineno"> 2</span>         <span class="k">if</span><span class="o">(</span><span class="n">root</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span><span class="o">;</span>
<span class="lineno"> 3</span>         
<span class="lineno"> 4</span>         <span class="n">TreeNode</span> <span class="n">pre</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno"> 5</span>         <span class="k">while</span><span class="o">(</span><span class="n">root</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno"> 6</span>             <span class="k">if</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">left</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno"> 7</span>                 <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">val</span><span class="o">);</span>
<span class="lineno"> 8</span>                 <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno"> 9</span>             <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">10</span>                 <span class="cm">/* find predecessor */</span>
<span class="lineno">11</span>                 <span class="n">pre</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">12</span>                 <span class="k">while</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="n">root</span><span class="o">)</span>
<span class="lineno">13</span>                     <span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">14</span>                 
<span class="lineno">15</span>                 <span class="cm">/* if predecessor&#39;s right == null, set current node as its right child */</span>
<span class="lineno">16</span>                 <span class="k">if</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno">17</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">18</span>                     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">val</span><span class="o">);</span>
<span class="lineno">19</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">20</span>                 <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">21</span>                     <span class="cm">/* recover tree, when return to parent node the second time */</span>
<span class="lineno">22</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno">23</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">24</span>                 <span class="o">}</span>
<span class="lineno">25</span>             <span class="o">}</span>
<span class="lineno">26</span>         <span class="o">}</span>
<span class="lineno">27</span>     <span class="o">}</span></code></pre></div>
    </div>

<h3>postorder</h3>

<p>We need to create a dummy node and set root as its left child.</p>

<p>The presudo code is below:</p>


    <div class="code-block">
    <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="lineno"> 1</span> <span class="n">initialize</span> <span class="n">current</span> <span class="k">as</span> <span class="n">root</span>
<span class="lineno"> 2</span>   <span class="k">while</span> <span class="n">current</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">NULL</span><span class="p">:</span> 
<span class="lineno"> 3</span>     <span class="k">if</span> <span class="n">current</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">have</span> <span class="n">left</span> <span class="n">child</span><span class="p">:</span>
<span class="lineno"> 4</span>         <span class="n">Go</span> <span class="n">to</span> <span class="n">the</span> <span class="n">right</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">right</span>
<span class="lineno"> 5</span>     <span class="k">else</span><span class="p">:</span>
<span class="lineno"> 6</span>        <span class="n">a</span><span class="o">.</span> <span class="n">Find</span> <span class="n">the</span> <span class="n">predecessor</span> <span class="n">of</span> <span class="n">current</span> <span class="n">node</span>
<span class="lineno"> 7</span>        <span class="n">b</span><span class="o">.</span> <span class="k">if</span> <span class="n">predecessor</span><span class="s">&#39;s right child is null:</span>
<span class="lineno"> 8</span>            <span class="mi">1</span><span class="p">)</span> <span class="n">make</span> <span class="n">current</span> <span class="n">the</span> <span class="n">right</span> <span class="n">child</span> <span class="n">of</span> <span class="n">its</span> <span class="n">predecessor</span>
<span class="lineno"> 9</span>            <span class="mi">2</span><span class="p">)</span><span class="n">Go</span> <span class="n">to</span> <span class="n">this</span> <span class="n">left</span> <span class="n">child</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">current</span> <span class="o">=</span> <span class="n">current</span><span class="o">-&gt;</span><span class="n">left</span>
<span class="lineno">10</span>         <span class="k">else</span><span class="p">:</span>
<span class="lineno">11</span>            <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">predecessor</span><span class="s">&#39;s right child is current node, set predecessor&#39;</span><span class="n">s</span> <span class="n">right</span> <span class="n">child</span> <span class="n">to</span> <span class="n">null</span>
<span class="lineno">12</span>            <span class="mi">2</span><span class="p">)</span> <span class="k">print</span> <span class="n">out</span> <span class="nb">all</span> <span class="n">nodes</span> <span class="n">on</span> <span class="n">path</span> <span class="kn">from</span> <span class="nn">current</span><span class="s">&#39;s left to current&#39;</span><span class="n">s</span> <span class="n">predecessor</span> <span class="n">reversely</span><span class="o">.</span>
<span class="lineno">13</span>            <span class="mi">3</span><span class="p">)</span> <span class="nb">set</span> <span class="n">current</span> <span class="n">node</span> <span class="n">to</span> <span class="n">its</span> <span class="n">right</span> <span class="n">child</span></code></pre></div>
    </div>

<p>java implementation:</p>

    <div class="code-block">
    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">morrisTraversal</span><span class="o">(</span><span class="n">TreeNode</span> <span class="n">root</span><span class="o">){</span>
<span class="lineno"> 2</span>         <span class="k">if</span><span class="o">(</span><span class="n">root</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span><span class="o">;</span>
<span class="lineno"> 3</span>         
<span class="lineno"> 4</span>         <span class="n">TreeNode</span> <span class="n">pre</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno"> 5</span>         <span class="n">TreeNode</span> <span class="n">dummy</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">TreeNode</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
<span class="lineno"> 6</span>         <span class="n">dummy</span><span class="o">.</span><span class="na">left</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno"> 7</span>         <span class="n">root</span> <span class="o">=</span> <span class="n">dummy</span><span class="o">;</span>
<span class="lineno"> 8</span>         <span class="k">while</span><span class="o">(</span><span class="n">root</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno"> 9</span>             <span class="k">if</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">left</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno">10</span>                 <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">11</span>             <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">12</span>                 <span class="cm">/* find predecessor */</span>
<span class="lineno">13</span>                 <span class="n">pre</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">14</span>                 <span class="k">while</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="n">root</span><span class="o">)</span>
<span class="lineno">15</span>                     <span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">16</span>                 
<span class="lineno">17</span>                 <span class="cm">/* if predecessor&#39;s right == null, set current node as its right child */</span>
<span class="lineno">18</span>                 <span class="k">if</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno">19</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">20</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">21</span>                 <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">22</span>                     <span class="cm">/* recover tree, when return to parent node the second time */</span>
<span class="lineno">23</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno">24</span>                     <span class="n">printPathReverse</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">,</span> <span class="n">pre</span><span class="o">);</span>
<span class="lineno">25</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">26</span>                 <span class="o">}</span>
<span class="lineno">27</span>             <span class="o">}</span>
<span class="lineno">28</span>         <span class="o">}</span>
<span class="lineno">29</span>     <span class="o">}</span></code></pre></div>
    </div>

    <h2> Recover binary tree use morris traverse</h2>
    <p>Two elements of a binary search tree (BST) are swapped by mistake. Recover the tree without changing its structure.<p>
    <p>We can easily solve this problem by recursion or using stack. What should we do if it requires us to use constant space? Mirros Traverse! </p>

    <p>java implementation:</p>

    <div class="code-block">
    <div class="highlight"><pre><code class="language-java" data-lang="java"><span class="lineno"> 1</span> <span class="kn">package</span> <span class="n">leetcode</span><span class="o">;</span>
<span class="lineno"> 2</span> 
<span class="lineno"> 3</span> <span class="cm">/**</span>
<span class="lineno"> 4</span> <span class="cm"> * @author wish</span>
<span class="lineno"> 5</span> <span class="cm"> *</span>
<span class="lineno"> 6</span> <span class="cm"> */</span>
<span class="lineno"> 7</span> <span class="kd">public</span> <span class="kd">class</span> <span class="nc">BinaryTree_RecoverBinarySearchTree</span> <span class="o">{</span>
<span class="lineno"> 8</span>     <span class="cm">/*</span>
<span class="lineno"> 9</span> <span class="cm">     * O(1) space</span>
<span class="lineno">10</span> <span class="cm">     */</span>
<span class="lineno">11</span>     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">recoverTree</span><span class="o">(</span><span class="n">TreeNode</span> <span class="n">root</span><span class="o">)</span> <span class="o">{</span>
<span class="lineno">12</span>         <span class="cm">/* arr[0] arr[1] stroe two swapped elements, arr[2] store pre.*/</span>
<span class="lineno">13</span>         <span class="n">TreeNode</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TreeNode</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
<span class="lineno">14</span>         <span class="n">morrisTraversal</span><span class="o">(</span><span class="n">root</span><span class="o">,</span> <span class="n">arr</span><span class="o">);</span>
<span class="lineno">15</span>         <span class="kt">int</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">val</span><span class="o">;</span>
<span class="lineno">16</span>         <span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">].</span><span class="na">val</span> <span class="o">=</span> <span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">val</span><span class="o">;</span>
<span class="lineno">17</span>         <span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">].</span><span class="na">val</span> <span class="o">=</span> <span class="n">temp</span><span class="o">;</span>
<span class="lineno">18</span>     <span class="o">}</span>
<span class="lineno">19</span>     
<span class="lineno">20</span>     
<span class="lineno">21</span>     <span class="kd">public</span> <span class="kt">void</span> <span class="nf">morrisTraversal</span><span class="o">(</span><span class="n">TreeNode</span> <span class="n">root</span><span class="o">,</span> <span class="n">TreeNode</span><span class="o">[]</span> <span class="n">arr</span><span class="o">){</span>
<span class="lineno">22</span>         <span class="k">if</span><span class="o">(</span><span class="n">root</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span><span class="o">;</span>
<span class="lineno">23</span>         
<span class="lineno">24</span>         <span class="n">TreeNode</span> <span class="n">pre</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span> <span class="cm">/* predecessor*/</span>
<span class="lineno">25</span>         <span class="n">TreeNode</span> <span class="n">previous</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno">26</span>         <span class="k">while</span><span class="o">(</span><span class="n">root</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno">27</span>             <span class="k">if</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">left</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno">28</span>                 <span class="k">if</span><span class="o">(</span> <span class="n">previous</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">previous</span><span class="o">.</span><span class="na">val</span> <span class="o">&gt;</span> <span class="n">root</span><span class="o">.</span><span class="na">val</span><span class="o">){</span>
<span class="lineno">29</span>                     <span class="k">if</span><span class="o">(</span><span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">previous</span><span class="o">;</span>
<span class="lineno">30</span>                     <span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">31</span>                 <span class="o">}</span>
<span class="lineno">32</span>                 <span class="n">previous</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">33</span>                 <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">34</span>             <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">35</span>                 <span class="cm">/* find predecessor */</span>
<span class="lineno">36</span>                 <span class="n">pre</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">37</span>                 <span class="k">while</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">!=</span> <span class="n">root</span><span class="o">)</span>
<span class="lineno">38</span>                     <span class="n">pre</span> <span class="o">=</span> <span class="n">pre</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">39</span>                 
<span class="lineno">40</span>                 <span class="cm">/* if predecessor&#39;s right == null, set current node as its right child */</span>
<span class="lineno">41</span>                 <span class="k">if</span><span class="o">(</span><span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
<span class="lineno">42</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">43</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">left</span><span class="o">;</span>
<span class="lineno">44</span>                 <span class="o">}</span><span class="k">else</span><span class="o">{</span>
<span class="lineno">45</span>                     <span class="cm">/* recover tree, when return to parent node the second time */</span>
<span class="lineno">46</span>                     <span class="n">pre</span><span class="o">.</span><span class="na">right</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="lineno">47</span>                     <span class="k">if</span><span class="o">(</span> <span class="n">previous</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">previous</span><span class="o">.</span><span class="na">val</span> <span class="o">&gt;</span> <span class="n">root</span><span class="o">.</span><span class="na">val</span><span class="o">){</span>
<span class="lineno">48</span>                         <span class="k">if</span><span class="o">(</span><span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">previous</span><span class="o">;</span>
<span class="lineno">49</span>                         <span class="n">arr</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">50</span>                     <span class="o">}</span>   
<span class="lineno">51</span>                     <span class="n">previous</span> <span class="o">=</span> <span class="n">root</span><span class="o">;</span>
<span class="lineno">52</span>                     <span class="n">root</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="na">right</span><span class="o">;</span>
<span class="lineno">53</span>                 <span class="o">}</span>
<span class="lineno">54</span>             <span class="o">}</span>
<span class="lineno">55</span>         <span class="o">}</span>
<span class="lineno">56</span>     <span class="o">}</span>
<span class="lineno">57</span> <span class="o">}</span></code></pre></div>
    </div>


</div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page3">Previous</a>
  
  
    
      <a class="pagination-item newer" href="/">Next</a>
    
  
</div>


  <div class="comments">
    <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'andersonvom'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  </div>


      </main>
      </div>


     <!--  <footer class="footer">
        <small>
          &copy; <time datetime="2015-01-24T09:55:53-06:00">2015</time>. All rights reserved.
        </small>
      </footer> -->
    </div>
      <div id="bg">
      <img src="/public/image/28.jpg"  alt="">
     </div>
  <div id = "container1"></div>
  </body>
      <!-- js -->
<script type="text/javascript" src='/public/js/sketch.min.js'></script>
<script type="text/javascript" src="/public/js/index.js"></script>

</html>
